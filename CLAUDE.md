# Supplie Manager - Claude Project Documentation

## é¡¹ç›®æ¦‚è¿°
Supplie Manager æ˜¯ä¸€ä¸ªç”¨ SwiftUI å¼€å‘çš„ iOS åº”ç”¨ï¼Œç”¨äºç®¡ç† 3D æ‰“å°è€—æï¼ˆææ–™ï¼‰ã€‚è¯¥åº”ç”¨æä¾›ææ–™åº“å­˜ç®¡ç†ã€ä½¿ç”¨é‡ç»Ÿè®¡ã€é¢„è®¾ç®¡ç†ä»¥åŠä¸ Bambu Lab æ‰“å°æœºçš„é›†æˆåŠŸèƒ½ã€‚

## æŠ€æœ¯æ ˆ
- **å¹³å°**: iOS
- **UIæ¡†æ¶**: SwiftUI
- **è¯­è¨€**: Swift
- **æœ€ä½æ”¯æŒç‰ˆæœ¬**: iOS 16.2
- **ä¾èµ–ç®¡ç†**: Swift Package Manager

## é¡¹ç›®ç»“æ„
```
Supplie Manager/
â”œâ”€â”€ Models/                      # æ•°æ®æ¨¡å‹
â”‚   â”œâ”€â”€ BambuAuthModel.swift     # Bambu Lab è®¤è¯æ¨¡å‹
â”‚   â”œâ”€â”€ BambuPrinterModel.swift  # æ‰“å°æœºçŠ¶æ€æ¨¡å‹
â”‚   â”œâ”€â”€ MaterialModels.swift     # ææ–™æ•°æ®æ¨¡å‹
â”‚   â”œâ”€â”€ MaterialModelsPresets.swift # ææ–™é¢„è®¾æ¨¡å‹
â”‚   â”œâ”€â”€ PrinterStatusModel.swift # æ‰“å°æœºçŠ¶æ€ç®¡ç†
â”‚   â””â”€â”€ ThreeMFModels.swift      # 3MF æ–‡ä»¶æ¨¡å‹
â”œâ”€â”€ Views/                       # è§†å›¾ç»„ä»¶
â”‚   â”œâ”€â”€ Material/               # ææ–™ç›¸å…³è§†å›¾
â”‚   â”‚   â”œâ”€â”€ AddMaterialView.swift
â”‚   â”‚   â”œâ”€â”€ ContentView.swift    # ä¸»ç•Œé¢ï¼ˆTabViewï¼‰
â”‚   â”‚   â””â”€â”€ MyMaterialsView.swift
â”‚   â”œâ”€â”€ Printer/                # æ‰“å°æœºç›¸å…³è§†å›¾
â”‚   â”‚   â”œâ”€â”€ BambuLoginView.swift
â”‚   â”‚   â””â”€â”€ BambuPrinterStatusView.swift
â”‚   â”œâ”€â”€ Settings/               # è®¾ç½®ç›¸å…³è§†å›¾
â”‚   â”‚   â”œâ”€â”€ MaterialPresetPreviewSheet.swift
â”‚   â”‚   â”œâ”€â”€ PresetComponents.swift
â”‚   â”‚   â””â”€â”€ PresetManagementView.swift
â”‚   â”œâ”€â”€ Stats/                  # ç»Ÿè®¡ç›¸å…³è§†å›¾
â”‚   â”‚   â”œâ”€â”€ AddPrintTaskToStatsView.swift
â”‚   â”‚   â”œâ”€â”€ RecordUsageView.swift
â”‚   â”‚   â””â”€â”€ StatisticsView.swift
â”‚   â””â”€â”€ Tools/                  # å·¥å…·ç›¸å…³è§†å›¾
â”‚       â”œâ”€â”€ ThreeMFPreviewView.swift
â”‚       â””â”€â”€ ToolsView.swift
â”œâ”€â”€ Services/                   # æœåŠ¡å±‚ï¼ˆå¾…å¼€å‘ï¼‰
â”œâ”€â”€ Resources/                  # èµ„æºæ–‡ä»¶
â”‚   â””â”€â”€ MaterialPresets.json    # ææ–™é¢„è®¾é…ç½®
â””â”€â”€ Assets.xcassets/           # å›¾ç‰‡èµ„æº
```

## å¤–éƒ¨ä¾èµ–
é¡¹ç›®é…ç½®äº†ä»¥ä¸‹ä¾èµ–ä½†å½“å‰ä»£ç ä¸­æœªå®é™…ä½¿ç”¨ï¼Œå»ºè®®åœ¨ä¸éœ€è¦æ—¶ç§»é™¤ï¼š

1. **CocoaMQTT** (v2.1.9) - æœªä½¿ç”¨
   - é…ç½®ç”¨é€”: ä¸ Bambu Lab æ‰“å°æœºçš„ MQTT é€šä¿¡
   - ä»“åº“: https://github.com/emqx/CocoaMQTT.git

2. **MqttCocoaAsyncSocket** (v1.0.8) - æœªä½¿ç”¨
   - é…ç½®ç”¨é€”: MQTT è¿æ¥çš„åº•å±‚ Socket æ”¯æŒ
   - ä»“åº“: https://github.com/leeway1208/MqttCocoaAsyncSocket

3. **Starscream** (v4.0.8) - æœªä½¿ç”¨
   - é…ç½®ç”¨é€”: WebSocket è¿æ¥æ”¯æŒ
   - ä»“åº“: https://github.com/daltoniam/Starscream.git

**æ³¨æ„**: å½“å‰é¡¹ç›®ä»…ä½¿ç”¨æ ‡å‡†çš„ URLSession è¿›è¡Œ HTTP API è°ƒç”¨ï¼Œä¸Šè¿°ä¾èµ–æœªè¢«å®é™…ä½¿ç”¨ã€‚

## æ ¸å¿ƒåŠŸèƒ½æ¨¡å—

### 1. ææ–™ç®¡ç† (Material)
- **æ•°æ®æ¨¡å‹**: `Material` ç»“æ„ä½“åŒ…å«å“ç‰Œã€åˆ†ç±»ã€é¢œè‰²ã€é‡é‡ã€ä»·æ ¼ç­‰ä¿¡æ¯
- **å­˜å‚¨**: æœ¬åœ° JSON å­˜å‚¨ï¼Œé€šè¿‡ `MaterialStore` ç®¡ç†
- **åŠŸèƒ½**: æ·»åŠ ã€ç¼–è¾‘ã€åˆ é™¤ææ–™ï¼Œè·Ÿè¸ªä½¿ç”¨é‡å’Œå‰©ä½™é‡

### 2. ç»Ÿè®¡æ¨¡å— (Stats)
- **åŠŸèƒ½**: è®°å½•æ‰“å°ä»»åŠ¡å’Œææ–™ä½¿ç”¨é‡
- **æ•°æ®å¯è§†åŒ–**: æä¾›ä½¿ç”¨ç»Ÿè®¡å›¾è¡¨å’ŒæŠ¥å‘Š

### 3. é¢„è®¾ç®¡ç† (Settings)
- **ææ–™é¢„è®¾**: é¢„å®šä¹‰çš„å¸¸ç”¨ææ–™é…ç½®
- **é…ç½®æ–‡ä»¶**: `MaterialPresets.json` å­˜å‚¨é¢„è®¾æ•°æ®

### 4. Bambu Lab é›†æˆ (Printer)
- **è®¤è¯**: æ”¯æŒ Bambu Lab è´¦æˆ·ç™»å½•
- **MQTT é€šä¿¡**: å®æ—¶è·å–æ‰“å°æœºçŠ¶æ€
- **æ‰“å°ä»»åŠ¡**: ç›‘æ§æ‰“å°è¿›åº¦å’Œææ–™æ¶ˆè€—

### 5. å·¥å…·æ¨¡å— (Tools)
- **3MF é¢„è§ˆ**: æ”¯æŒ 3MF æ–‡ä»¶çš„é¢„è§ˆå’Œåˆ†æ
- **å…¶ä»–å·¥å…·**: æ‰©å±•åŠŸèƒ½é›†åˆ

## å¼€å‘æŒ‡å—

### æ„å»ºè¦æ±‚
- Xcode 16.2+
- Swift 5.9+
- macOS 14.0+ (å¼€å‘ç¯å¢ƒ)
- iOS 16.2+ (ç›®æ ‡å¹³å°)

### ç½‘ç»œæƒé™é…ç½®
é¡¹ç›®åœ¨ `Supplie-Manager-Info.plist` ä¸­é…ç½®äº†ä»¥ä¸‹ç½‘ç»œæƒé™ï¼š
- å…è®¸æœ¬åœ°ç½‘ç»œè®¿é—®ï¼ˆç”¨äºæ‰“å°æœºé€šä¿¡ï¼‰
- Bambu Lab MQTT æœåŠ¡å™¨ä¾‹å¤–é…ç½®
- åå°å¤„ç†æƒé™ï¼ˆç”¨äºæ•°æ®åŒæ­¥ï¼‰

### ä¸»è¦æ¶æ„æ¨¡å¼
- **MVVM**: ä½¿ç”¨ `@StateObject` å’Œ `@ObservableObject` è¿›è¡ŒçŠ¶æ€ç®¡ç†
- **ç»„åˆå¼æ¶æ„**: æ¯ä¸ªåŠŸèƒ½æ¨¡å—ç‹¬ç«‹å¼€å‘ï¼Œé€šè¿‡ä¸»ç•Œé¢ç»„åˆ
- **æ•°æ®æŒä¹…åŒ–**: JSON æ–‡ä»¶æœ¬åœ°å­˜å‚¨

### å¼€å‘å»ºè®®
1. **ä»£ç é£æ ¼**: éµå¾ª Swift å®˜æ–¹ç¼–ç è§„èŒƒ
2. **UI è®¾è®¡**: ä½¿ç”¨ SwiftUI åŸç”Ÿç»„ä»¶ï¼Œä¿æŒ Apple è®¾è®¡è¯­è¨€ä¸€è‡´æ€§
3. **æ•°æ®ç®¡ç†**: é€šè¿‡ Store æ¨¡å¼é›†ä¸­ç®¡ç†çŠ¶æ€
4. **ç½‘ç»œè¯·æ±‚**: å¼‚æ­¥å¤„ç†ï¼Œä½¿ç”¨ async/await æ¨¡å¼
5. **é”™è¯¯å¤„ç†**: å®ç°å®Œå–„çš„é”™è¯¯æ•è·å’Œç”¨æˆ·åé¦ˆæœºåˆ¶

### å¸¸ç”¨å‘½ä»¤
```bash
# æ„å»ºé¡¹ç›®
xcodebuild -project "Supplie Manager.xcodeproj" -scheme "Supplie Manager" build

# è¿è¡Œæµ‹è¯•
xcodebuild test -project "Supplie Manager.xcodeproj" -scheme "Supplie Manager"

# æ¸…ç†æ„å»º
xcodebuild clean -project "Supplie Manager.xcodeproj" -scheme "Supplie Manager"
```

## å½“å‰å¼€å‘çŠ¶æ€
- âœ… åŸºç¡€ææ–™ç®¡ç†åŠŸèƒ½
- âœ… ä¸»ç•Œé¢å’Œå¯¼èˆªç»“æ„
- âœ… Bambu Lab æ‰“å°æœºé›†æˆ
- âœ… ææ–™é¢„è®¾ç³»ç»Ÿ
- âœ… 3MF æ–‡ä»¶é¢„è§ˆåŠŸèƒ½
- ğŸ”„ ç»Ÿè®¡å’Œæ•°æ®å¯è§†åŒ–ä¼˜åŒ–ä¸­
- ğŸ“‹ Services å±‚æ¶æ„å¾…å®Œå–„

## æ³¨æ„äº‹é¡¹
1. è¯¥åº”ç”¨éœ€è¦ç½‘ç»œæƒé™ä»¥è¿æ¥ Bambu Lab æ‰“å°æœº
2. ææ–™æ•°æ®å­˜å‚¨åœ¨æœ¬åœ°ï¼Œå»ºè®®å®ç°æ•°æ®å¤‡ä»½åŠŸèƒ½
3. MQTT è¿æ¥éœ€è¦ç¨³å®šçš„ç½‘ç»œç¯å¢ƒ
4. 3MF æ–‡ä»¶å¤„ç†å¯èƒ½å ç”¨è¾ƒå¤šå†…å­˜ï¼Œéœ€è¦ä¼˜åŒ–å¤§æ–‡ä»¶å¤„ç†

## è”ç³»ä¿¡æ¯
- å¼€å‘è€…: PigeonMuyz
- é¡¹ç›®è·¯å¾„: `/Users/huangtianchen/XCodeProject/Supplie Manager`